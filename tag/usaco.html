<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8">
        <title>Programming Journey - USACO</title>
        <link rel="stylesheet" href="http://hsiangholin.github.io/theme/css/main.css">
                <link href="http://hsiangholin.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Programming Journey Atom Feed" />
                
        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://hsiangholin.github.io/">Programming Journey </a></h1>
                <nav><ul>
                                                                                    <li ><a href="http://hsiangholin.github.io/category/c.html">C</a></li>
                                    <li ><a href="http://hsiangholin.github.io/category/python.html">Python</a></li>
                                                </ul></nav>
        </header><!-- /#banner -->
                
            

                            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="http://hsiangholin.github.io/usaco-broken-necklace.html">USACO Section 1.1 Broken Necklace</a></h1> 
                    <footer class="post-info">
        <abbr class="published" title="2013-11-30T14:42:00">
                Sat 30 November 2013
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="http://hsiangholin.github.io/author/hsiang-ho-lin.html">Hsiang-Ho Lin</a>
        </address>
        <p>In <a href="http://hsiangholin.github.io/category/c.html">C</a>. </p>
<p>tags: <a href="http://hsiangholin.github.io/tag/c.html">C</a><a href="http://hsiangholin.github.io/tag/usaco.html">USACO</a></p>
</footer><!-- /.post-info --><h1>The Problem</h1>
<p>Let's describe the problem briefly here. Given a string a necklace composed with Red, Blue and White beans, we are going to find the maximum number of beans we can collected if we can choose to break the necklace at a certain point. By "maximum number of beans we can collected", I mean starting from the break point, we collect beads of the same color from one end until you reach a bead of a different color, and do the same for the other end.</p>
<p>What's special is that when collecting beads, a white bead that is encountered may be treated as either red or blue and then painted with the desired color.</p>
<h1>The Solution</h1>
<p>At first I think I can just use the simple-minded approach which is to try to break the necklace at each point and calculate how much beans I can get at that certain point. When this is done from start to end, we are able to obtain the maximum number of beans we can collected.
However, I have a feeling that a dynamic programming algorithm would be much more challenging and fun. So this is my approach of dynamic programming.
The main idea here is to iterate the ring once and we can dynamically sum up the numbers of last two same color collections. Finally, the maximum of the sums is the answer.
1. We are going to duplicated the necklace string and concatenate one to the other. For instance, if the necklace is rbwwrbbb, it will be made rbwwrbbbrbwwrbbb. The reason for this is that necklace is actually a ring, not a list. By doing this, we provide the illusion for the program that we are iterating in the ring.
2. Supposing we only have red and blue beans, while iterating the string from head to tail, we accumulate beans with same color, and if we have encountered a different color from what we are collecting now (let's call it a "color change"), we will store the current number of same color beans and start accumulate beans with the other color. In the meanwhile of "color change", we are going to sum up the past two numbers of different color beans collection, and compare it to the maximum number, if the sum is greater, replace the maximum number with the sum.
For instance, when we encounter the 5th bean "r" in rrbbrrrb, we have already stored the number of first 2 "r"s, 2, and the 3rd and 4th beans "b"s, 2, so now we got 2+2=4 to be our maximum. If we encounter the 8th bean "b", this "color change" yields sum=2+3=5, and replace maximum with 5.
3. Things got more complicated when white color joins. When we are iterating on "w" beans, we add the count to the current collection, assuming we are coloring these "w" beans to the color we are collecting. But when we encounters a "color change" (rw...b or bw...r), after maximum is compared to the sum, we are going the color the before collected white beans into the new color, maximizing the next collection.
For instance, brwwwbr will be viewed as brrrrbr when we are at the 5th bean, but it becomes brbbbbr when we get to the 6th bean.</p>
<h1>Conclusion</h1>
<p>By sticking to the above three principles, we can dynamically sum up the numbers of last two same color collections, which can find the answer in O(n).</p>
<h1>Source Code</h1>
<div class="highlight"><pre><span class="cp">#include &lt;stdio.h&gt; </span>
<span class="cp">#define BUF_SIZE 1024 </span>
<span class="kt">int</span> <span class="nf">main</span> <span class="p">()</span> <span class="p">{</span> 
    <span class="kt">FILE</span> <span class="n">fin</span> <span class="o">=</span> <span class="n">fopen</span> <span class="p">(</span><span class="s">&quot;beads.in&quot;</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">);</span> 
    <span class="kt">FILE</span> <span class="n">fout</span> <span class="o">=</span> <span class="n">fopen</span> <span class="p">(</span><span class="s">&quot;beads.out&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">);</span> 
    <span class="kt">int</span> <span class="n">size</span><span class="p">;</span> 
    <span class="kt">int</span> <span class="n">it_len</span><span class="p">;</span> 
    <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> 
    <span class="kt">int</span> <span class="n">state</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> 
    <span class="kt">char</span> <span class="n">beads</span><span class="p">[</span><span class="n">BUF_SIZE</span><span class="p">];</span> 
    <span class="kt">int</span> <span class="n">answer</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
    <span class="kt">int</span> <span class="n">sum1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
    <span class="kt">int</span> <span class="n">sum2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
    <span class="kt">int</span> <span class="n">w_combo</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
    <span class="kt">int</span> <span class="n">w_walk</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
    <span class="k">if</span><span class="p">(</span><span class="n">fin</span><span class="p">)</span> 
    <span class="p">{</span> 
        <span class="n">fscanf</span><span class="p">(</span><span class="n">fin</span><span class="p">,</span> <span class="s">&quot;%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">size</span><span class="p">);</span> 
        <span class="n">fgets</span><span class="p">(</span><span class="n">beads</span><span class="p">,</span> <span class="n">BUF_SIZE</span><span class="p">,</span> <span class="n">fin</span><span class="p">);</span> 
        <span class="n">it_len</span> <span class="o">=</span> <span class="n">size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span> 
        <span class="n">memcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">beads</span><span class="p">[</span><span class="n">size</span><span class="p">],</span><span class="o">&amp;</span><span class="n">beads</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">size</span><span class="p">);</span> 
        <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">it_len</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> 
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">beads</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;r&#39;</span> <span class="o">||</span> <span class="n">beads</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;b&#39;</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">sum2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="n">i</span><span class="o">++</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">sum2</span> <span class="o">=</span> <span class="n">size</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">it_len</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> 
        <span class="p">{</span> 
            <span class="k">if</span><span class="p">(</span><span class="n">beads</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;w&#39;</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">w_walk</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="n">w_combo</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> 
                <span class="n">sum2</span><span class="o">++</span><span class="p">;</span>
                <span class="n">beads</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">beads</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">beads</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">beads</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="p">{</span>
                <span class="n">sum2</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="k">if</span><span class="p">((</span><span class="n">sum1</span><span class="o">+</span><span class="n">sum2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">answer</span><span class="p">)</span>
                <span class="n">answer</span> <span class="o">=</span> <span class="n">sum1</span><span class="o">+</span><span class="n">sum2</span><span class="p">;</span>
                <span class="n">sum1</span> <span class="o">=</span> <span class="n">sum2</span><span class="p">;</span>
                <span class="n">sum2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="n">w_walk</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">sum2</span> <span class="o">+=</span> <span class="n">w_combo</span><span class="p">;</span>
                <span class="n">sum1</span> <span class="o">-=</span> <span class="n">w_combo</span><span class="p">;</span>
            <span class="p">}</span>
                <span class="n">w_walk</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="n">w_combo</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span> 
    <span class="p">}</span> 
    <span class="k">if</span><span class="p">((</span><span class="n">sum1</span><span class="o">+</span><span class="n">sum2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">answer</span><span class="p">)</span> 
        <span class="n">answer</span> <span class="o">=</span> <span class="n">sum1</span><span class="o">+</span><span class="n">sum2</span><span class="p">;</span> 
    <span class="k">if</span><span class="p">(</span><span class="n">answer</span> <span class="o">&gt;</span> <span class="n">size</span><span class="p">)</span> 
        <span class="n">answer</span> <span class="o">=</span> <span class="n">size</span><span class="p">;</span> 
    <span class="k">if</span><span class="p">(</span><span class="n">fout</span><span class="p">)</span> 
        <span class="n">fprintf</span> <span class="p">(</span><span class="n">fout</span><span class="p">,</span> <span class="s">&quot;%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">answer</span><span class="p">);</span> 
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</pre></div>


<p>}</p>                </article>
                                    <p class="paginator">
        Page 1 / 1
    </p>
                            </aside><!-- /#featured -->
                                                </ol><!-- /#posts-list -->
                        </section><!-- /#content -->
                    <section id="extras" class="body">
                        <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                                                    <li><a href="http://getpelican.com/">Pelican</a></li>
                                                    <li><a href="http://python.org/">Python.org</a></li>
                                                    <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                                                    <li><a href="#">You can modify those links in your config file</a></li>
                                                </ul>
                </div><!-- /.blogroll -->
                                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://hsiangholin.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                            
                                                    <li><a href="#">You can add links in your config file</a></li>
                                                    <li><a href="#">Another social link</a></li>
                                                </ul>
                </div><!-- /.social -->
                </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>